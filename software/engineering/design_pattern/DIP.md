# Dependency Inversion Principle (依賴反向原則)

---

## 依賴反向原則的介紹、解釋及優點

---

`最靈活的系統是『原始碼只依賴抽象而不依賴具體』的那些系統。`

`沒有具體的東西就該被依賴。`

`use, import , include 語句就應該只餐靠道包含介面、抽象類別或其他類型的抽象宣告之原始碼模組`

當然，上述的是理想情況，實際上我們總會有需要依賴的『具體』，但我們應該只依賴像是『 String, 作業系統背景等等』穩定到可以視為不會更改之『具體』，其他我們都該依賴抽象。

### 解釋

---

- 為什麼我們要依賴抽象？
  - 因為抽象是高層業務規則、是程式的目的、是不易變更的、是一變動就得改動實作的、也是實作改動後有可能不用動的。
  - 因為實作是所有處理業務規則的實作細節、是為了滿足抽象、是容易變動的。
  - 我們單看『實作是抽象的細節』就可以確定，我們該讓實作跟著抽象走、而非抽象跟著實作走，換言之，得依賴抽象。
- 為什麼叫『依賴反向』？
  - 首先先提到抽象工廠模式，用言語表達就有點像是我們透過一個抽象工廠連接一個具體工廠，而一個具體工廠能夠生產出一個具體物件，同時再透過一個抽象的『服務』、抽象工廠為我們作的『服務』，有點像是用一個抽象去當作我們的服務接受器，這個服務接收器去收取具體產品。
  - 接著我們來分析依賴關係：
     1. 具體工廠依賴抽象工廠
     2. 具體工廠產品依賴抽象的服務接受器
     3. 具體工廠依賴具體產品(因為工廠要依據產品決定是怎樣的一個工廠)
  - 再來分析控制關係：
     1. 抽象工廠控制具體工廠
     2. 服務接受器控制(接受)具體產品
     3. 具體產品控制了具體工廠的長相
  - 依賴跟控制是相反的，這就是的『依賴反向』由來。
- 由上面分析的第三點可看出，我們無可避免地違反 DIP 、出現了依賴具體的情況，實務上的解決應該是將這些違反的情況收集到少量的具體元件中、並與不違反的元件區隔開來。